y = "Bing Positivity Score",
title = "Positivity of Tweets") +
scale_color_discrete("Dataset")
p
?scale_color_discrete
p <-ggplot(data=tweet_score, aes(x=factor(word), y=score*n, fill = score * n)) +
geom_bar(stat="identity") +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
labs(size= "Nitrogen",
x = "Most Common Words in Tweets",
y = "Positivity Score",
title = "Positivity of Tweets") +
guide_legend(title = "This")
?guide_legend
p <-ggplot(data=tweet_score, aes(x=factor(word), y = score * n, fill = score * n)) +
geom_bar(stat="identity") +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
labs(size= "Nitrogen",
x = "Most Common Words in Tweets",
y = "Positivity Score",
title = "Positivity of Tweets") +
guide_legend(title = waiver())
p <-ggplot(data=tweet_score, aes(x=factor(word), y = score * n, fill = score * n)) +
geom_bar(stat="identity") +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
labs(x = "Most Common Words in Tweets",
y = "Positivity Score",
title = "Positivity of Tweets") +
guide_legend(title = waiver())
p <-ggplot(data=tweet_score, aes(x=factor(word), y = score * n, fill = score * n)) +
geom_bar(stat="identity") +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
labs(x = "Most Common Words in Tweets",
y = "Positivity Score",
title = "Positivity of Tweets") +
scale_fill_manual(name = "LEngend")
p
p <-ggplot(data=tweet_score, aes(x=factor(word), y = score * n, fill = score * n)) +
geom_bar(stat="identity") +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
labs(x = "Most Common Words in Tweets",
y = "Positivity Score",
title = "Positivity of Tweets"
fill = "Positivity")
p <-ggplot(data=tweet_score, aes(x=factor(word), y = score * n, fill = score * n)) +
geom_bar(fill = (repo < 0), stat="identity") +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
scale_fill_manual(guide = FALSE, breaks = c(TRUE, FALSE), values=c("red", "green"))
labs(x = "Most Common Words in Tweets",
y = "Positivity Score",
title = "Positivity of Tweets",
fill = "Positivity")
p
p <-ggplot(data=tweet_score, aes(x=factor(word), y = score * n, fill = score * n)) +
geom_bar(fill = (repo < 0), stat="identity") +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
scale_fill_manual(guide = FALSE, breaks = c(TRUE, FALSE), values=c("red", "green")) +
labs(x = "Most Common Words in Tweets",
y = "Positivity Score",
title = "Positivity of Tweets",
fill = "Positivity")
p <-ggplot(data=tweet_score, aes(x=factor(word), y = score * n, fill = score * n)) +
geom_bar(fill = (score * n < 0), stat="identity") +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
scale_fill_manual(guide = FALSE, breaks = c(TRUE, FALSE), values=c("red", "green")) +
labs(x = "Most Common Words in Tweets",
y = "Positivity Score",
title = "Positivity of Tweets",
fill = "Positivity")
score <- tweet_score$score
total_score <- tweet_score$score * tweet_score$n
p <-ggplot(data = tweet_score, aes(x=factor(word), y = score * n, fill = score * n)) +
geom_bar(fill = (tweetscore * n < 0), stat="identity") +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
scale_fill_manual(guide = FALSE, breaks = c(TRUE, FALSE), values=c("red", "green")) +
labs(x = "Most Common Words in Tweets",
y = "Positivity Score",
title = "Positivity of Tweets",
fill = "Positivity")
total_score <- tweet_score$score * tweet_score$n
p <-ggplot(data = tweet_score, aes(x=factor(word), y = total_score, fill = total_score)) +
geom_bar(fill = (total_score < 0), stat="identity") +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
scale_fill_manual(guide = FALSE, breaks = c(TRUE, FALSE), values=c("red", "green")) +
labs(x = "Most Common Words in Tweets",
y = "Positivity Score",
title = "Positivity of Tweets",
fill = "Positivity")
p
p <-ggplot(data = tweet_score, aes(x=factor(word), y = total_score, fill = total_score)) +
geom_bar(aes(fill = total_score < 0), stat = "identity") +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
scale_fill_manual(guide = FALSE, breaks = c(TRUE, FALSE), values=c("red", "green")) +
labs(x = "Most Common Words in Tweets",
y = "Positivity Score",
title = "Positivity of Tweets",
fill = "Positivity")
p
p <-ggplot(data = tweet_score, aes(x=factor(word), y = total_score, fill = total_score, fill = total_score) +
geom_bar(aes(fill = total_score < 0), stat = "identity") +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
scale_fill_manual(guide = FALSE, breaks = c(TRUE, FALSE), values=c("red", "green")) +
labs(x = "Most Common Words in Tweets",
y = "Positivity Score",
title = "Positivity of Tweets",
fill = "Positivity")
p
p <- ggplot(data = tweet_score, aes(x=factor(word), y = total_score, fill = total_score)) +
geom_bar(aes(fill = total_score < 0), stat = "identity") +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
scale_fill_manual(guide = FALSE, breaks = c(TRUE, FALSE), values=c("red", "green")) +
labs(x = "Most Common Words in Tweets",
y = "Positivity Score",
title = "Positivity of Tweets",
fill = "Positivity")
p
p <- ggplot(data = tweet_score, aes(x=factor(word), y = total_score, fill = total_score)) +
geom_bar(aes(fill = total_score < 0), stat = "identity") +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
scale_fill_manual(guide = FALSE, breaks = c(TRUE, FALSE), values=c("red", "green")) +
labs(x = "Most Common Words in Tweets",
y = "Positivity Score",
title = "Positivity of Tweets",
fill = "Positivity")
p
p <- ggplot(data = tweet_score, aes(x=factor(word), y = total_score)) +
geom_bar(aes(fill = total_score < 0), stat = "identity") +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
scale_fill_manual(guide = FALSE, breaks = c(TRUE, FALSE), values=c("green", "red")) +
labs(x = "Most Common Words in Tweets",
y = "Positivity Score",
title = "Positivity of Tweets",
fill = "Positivity")
p
tweet_sentiment
tweet_sentiment <- text %>%
inner_join(get_sentiments("bing"), by = "word") %>%
count(word, score, sort = TRUE) %>%
ungroup()
tweet_sentiment <- text %>%
inner_join(get_sentiments("nrc"), by = "word") %>%
count(word, score, sort = TRUE) %>%
ungroup()
tweet_sentiment <- text %>%
inner_join(get_sentiments("nrc"), by = "word") %>%
count(word, sort = TRUE) %>%
ungroup()
tweet_sentiment
tweet_sentiment <- text %>%
inner_join(get_sentiments("nrc"), by = "word") %>%
count(word, sort = TRUE) %>%
ungroup()
tweet_sentiment <- text %>%
inner_join(get_sentiments("nrc"), by = "word") %>%
count(word, sort = TRUE) %>%
ungroup()
tweet_sentiment
tweet_sentiment <- text %>%
inner_join(get_sentiments("nrc"), by = "word") %>%
count(word, sentiment, sort = TRUE) %>%
ungroup()
tweet_sentiment
tweet_sentiment <- text %>%
inner_join(get_sentiments("nrc"), by = "word") %>%
count(sentiment, word, sort = TRUE) %>%
ungroup()
tweet_sentiment
tweet_sentiment <- text %>%
inner_join(get_sentiments("nrc"), by = "word") %>%
count(word, sentiment, sort = TRUE) %>%
ungroup()
tweet_sentiment
tweet_score
tweet_sentiment <- text %>%
inner_join(get_sentiments("nrc"), by = "word") %>%
count(sentiment, sort = TRUE) %>%
ungroup()
tweet_sentiment
tweet_sentiment[3:8]
tweet_sentiment[,3:8]
tweet_sentiment[3:8,]
sentiment <- ggplot(tweet_sentiment[3:8,], aes(x = sentiment, y = n)) +
geom_bar(stat= "identity") +
coord_flip()
sentiment
sentiment <- ggplot(tweet_sentiment[3:8,], aes(x = factor(sentiment, levels = unique(sentiment)), y = n)) +
geom_bar(stat= "identity") +
coord_flip()
sentiment
tweet_sentiment <- text %>%
inner_join(get_sentiments("nrc"), by = "word") %>%
count(sentiment, -sort = TRUE) %>%
ungroup()
tweet_sentiment <- text %>%
inner_join(get_sentiments("nrc"), by = "word") %>%
rev(count(sentiment, sort = TRUE)) %>%
ungroup()
tweet_sentiment <- text %>%
inner_join(get_sentiments("nrc"), by = "word") %>%
count(sentiment, sort = TRUE) %>%
ungroup()
rev()
tweet_sentiment <- text %>%
inner_join(get_sentiments("nrc"), by = "word") %>%
count(sentiment, sort = TRUE) %>%
ungroup()
sentiment <- ggplot(tweet_sentiment[3:8,], aes(x = factor(sentiment, levels = unique(sentiment)), y = n)) +
geom_bar(stat= "identity") +
coord_flip()
sentiment
tweet_sentiment
sentiment <- ggplot(tweet_sentiment[3:8,], aes(x = rev(factor(sentiment, levels = unique(sentiment))), y = n)) +
geom_bar(stat= "identity") +
coord_flip()
sentiment
binary_sentiment <- text %>%
inner_join(get_sentiments("bing"), by = "word") %>%
count(sentiment, sort = TRUE) %>%
ungroup()
binary_sentiment
binary_sentiment <- tweet_sentiment %>%
inner_join(get_sentiments("bing"), by = "word") %>%
ungroup()
binary_sentiment <- tweet_sentiment %>%
inner_join(get_sentiments("bing"), by = "word") %>%
ungroup()
tweet_sentiment <- text %>%
inner_join(get_sentiments("nrc"), by = "word") %>%
count(sentiment, sort = TRUE) %>%
ungroup()
tweet_sentiment
tweet_sentiment <- text %>%
inner_join(get_sentiments("nrc"), by = "word") %>%
count(sentiment, sort = TRUE) %>%
ungroup()
rename(emotion = sentiment)
tweet_sentiment <- text %>%
inner_join(get_sentiments("nrc"), by = "word") %>%
count(sentiment, sort = TRUE) %>%
ungroup() %>%
rename(emotion = sentiment)
tweet_sentiment
tweet_sentiment <- text %>%
inner_join(get_sentiments("nrc"), by = "word") %>%
count(sentiment, sort = TRUE) %>%
ungroup() %>%
rename(emotion = sentiment)
tweet_sentiment
tweet_sentiment <- text %>%
inner_join(get_sentiments("nrc"), by = "word") %>%
count(word, sentiment, sort = TRUE) %>%
ungroup() %>%
rename(emotion = sentiment)
tweet_sentiment
tweet_sentiment <- text %>%
inner_join(get_sentiments("nrc"), by = "word") %>%
count(sentiment, sort = TRUE) %>%
ungroup() %>%
rename(emotion = sentiment)
tweet_sentiment
tweet_sentiment <- text %>%
inner_join(get_sentiments("nrc"), by = "word") %>%
count(sentiment, sort = TRUE) %>%
ungroup() %>%
rename(token = word, word = sentiment)
tweet_sentiment
tweet_sentiment <- text %>%
inner_join(get_sentiments("nrc"), by = "word") %>%
count(sentiment, sort = TRUE) %>%
ungroup() %>%
rename(word = emotion)
tweet_sentiment
tweet_sentiment <- text %>%
inner_join(get_sentiments("nrc"), by = "word") %>%
count(sentiment, sort = TRUE) %>%
ungroup() %>%
rename(word = emotion)
tweet_sentiment <- text %>%
inner_join(get_sentiments("nrc"), by = "word") %>%
count(sentiment, sort = TRUE) %>%
ungroup()
tweet_sentiment
tweet_sentiment <- text %>%
inner_join(get_sentiments("nrc"), by = "word") %>%
count(sentiment, sort = TRUE) %>%
ungroup() %>%
rename(word = sentiment)
tweet_sentiment
binary_sentiment <- tweet_sentiment %>%
inner_join(get_sentiments("bing"), by = "word") %>%
ungroup()
binary_sentiment
sentiment <- ggplot(tweet_sentiment[3:8,], aes(x = rev(factor(sentiment, levels = unique(sentiment))), y = n)) +
geom_bar(stat= "identity", aes(fill = factor(sentiment))) +
coord_flip()
labs(x = "Most Common Words in Tweets",
y = "Positivity Score",
title = "Positivity of Tweets",
fill = "Positivity")
sentiment
sentiment <- ggplot(tweet_sentiment[3:8,], aes(x = rev(factor(sentiment, levels = unique(sentiment))), y = n)) +
geom_bar(stat= "identity") +
coord_flip()
labs(x = "Most Common Words in Tweets",
y = "Positivity Score",
title = "Positivity of Tweets",
fill = "Positivity")
sentiment <- ggplot(tweet_sentiment[3:8,], aes(x = rev(factor(sentiment, levels = unique(sentiment))), y = n)) +
geom_bar(stat= "identity") +
coord_flip()
labs(x = "Most Common Words in Tweets",
y = "Positivity Score",
title = "Positivity of Tweets",
fill = "Positivity")
tweet_sentiment
binary_sentiment
sentiment <- ggplot(binary_sentiment[3:8,], aes(x = rev(factor(sentiment, levels = unique(sentiment))), y = n)) +
geom_bar(stat= "identity", aes(fill = sentiment)) +
coord_flip() +
labs(x = "Most Common Words in Tweets",
y = "Positivity Score",
title = "Positivity of Tweets",
fill = "Positivity")
sentiment
sentiment <- ggplot(binary_sentiment[3:8,], aes(x = rev(factor(word, levels = unique(sentiment))), y = n)) +
geom_bar(stat= "identity", aes(fill = sentiment)) +
coord_flip() +
labs(x = "Most Common Words in Tweets",
y = "Positivity Score",
title = "Positivity of Tweets",
fill = "Positivity")
sentiment
binary_sentiment
sentiment <- ggplot(binary_sentiment[3:8,], aes(x = rev(factor(word, levels = unique(word))), y = n)) +
geom_bar(stat= "identity", aes(fill = sentiment)) +
coord_flip() +
labs(x = "Most Common Words in Tweets",
y = "Positivity Score",
title = "Positivity of Tweets",
fill = "Positivity")
sentiment
sentiment <- ggplot(binary_sentiment[3:8,], aes(x = rev(factor(word, levels = unique(word))), y = n)) +
geom_bar(stat= "identity", aes(fill = sentiment)) +
coord_flip() +
labs(x = "Frequency",
y = "Most Common Emotions",
title = "Positivity of Tweets",
fill = "Positivity")
sentiment
sentiment <- ggplot(binary_sentiment[3:8,], aes(x = rev(factor(word, levels = unique(word))), y = n)) +
geom_bar(stat= "identity", aes(fill = sentiment)) +
coord_flip() +
labs(x = "Most Common Emotions",
y = "Frequency",
title = "Positivity of Tweets",
fill = "Positivity")
sentiment
sentiment <- ggplot(binary_sentiment[3:8,], aes(x = rev(factor(word, levels = unique(word))), y = n)) +
geom_bar(stat= "identity", aes(fill = sentiment)) +
coord_flip() +
labs(x = "Most Common Emotions",
y = "Frequency",
title = "Emotions Conveyed by Tweets",
fill = "Positivity")
sentiment
text <- data_frame(tweet = anti_gun_control_df$text) %>%
unnest_tokens(word, tweet)
tweet_score <- text %>%
inner_join(get_sentiments("afinn"), by = "word") %>%
count(word, score, sort = TRUE) %>%
ungroup()
# I split these up for clarity, although they could be combined
tweet_sentiment <- text %>%
inner_join(get_sentiments("nrc"), by = "word") %>%
count(sentiment, sort = TRUE) %>%
ungroup() %>%
rename(word = emotion)
binary_sentiment <- tweet_sentiment %>%
inner_join(get_sentiments("bing"), by = "word") %>%
ungroup()
total_score <- tweet_score$score * tweet_score$n
# I would like to point out that it was NOT easy to get those colors right
positivity_plot <- ggplot(data = tweet_score, aes(x=factor(word), y = total_score)) +
geom_bar(aes(fill = total_score < 0), stat = "identity") +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
scale_fill_manual(guide = FALSE, breaks = c(TRUE, FALSE), values=c("green", "red")) +
labs(x = "Most Common Words in Tweets",
y = "Positivity Score",
title = "Positivity of Tweets",
fill = "Positivity")
# Using only 3 through 8 since 'positive' and 'negative are by
# far the most popular sentiments, although they cannot be used
sentiment <- ggplot(binary_sentiment[3:8,], aes(x = rev(factor(word, levels = unique(word))), y = n)) +
geom_bar(stat= "identity", aes(fill = sentiment)) +
coord_flip() +
labs(x = "Most Common Emotions",
y = "Frequency",
title = "Emotions Conveyed by Tweets",
fill = "Positivity")
runApp()
runApp()
runApp()
anti_abortion_tweets <- searchTwitter("#noabortion", 30)
anti_gun_control_df <- twListToDF(anti_gun_control_tweets)
text <- data_frame(tweet = anti_gun_control_df$text) %>%
unnest_tokens(word, tweet)
tweet_score <- text %>%
inner_join(get_sentiments("afinn"), by = "word") %>%
count(word, score, sort = TRUE) %>%
ungroup()
tweet_sentiment <- text %>%
inner_join(get_sentiments("nrc"), by = "word") %>%
count(sentiment, sort = TRUE) %>%
ungroup() %>%
rename(word = emotion)
tweet_sentiment
tweet_sentiment <- text %>%
inner_join(get_sentiments("nrc"), by = "word") %>%
count(sentiment, sort = TRUE) %>%
ungroup() %>%
tweet_sentiment <- text %>%
inner_join(get_sentiments("nrc"), by = "word")
tweet_sentiment <- text %>%
inner_join(get_sentiments("nrc"), by = "word")
tweet_sentiment
text
tweet_sentiment <- text %>%
inner_join(get_sentiments("nrc"), by = "word") %>%
count(sentiment, sort = TRUE) %>%
ungroup() %>%
rename(emotion = word)
tweet_sentiment
text <- data_frame(tweet = anti_gun_control_df$text) %>%
unnest_tokens(word, tweet)
tweet_score <- text %>%
inner_join(get_sentiments("afinn"), by = "word") %>%
count(word, score, sort = TRUE) %>%
ungroup()
tweet_sentiment <- text %>%
inner_join(get_sentiments("nrc"), by = "word") %>%
count(sentiment, sort = TRUE) %>%
ungroup()
tweet_sentiment
tweet_sentiment <- text %>%
inner_join(get_sentiments("nrc"), by = "word") %>%
count(sentiment, sort = TRUE) %>%
ungroup() %>%
rename(word = sentiment)
tweet_sentiment
binary_sentiment <- tweet_sentiment %>%
inner_join(get_sentiments("bing"), by = "word") %>%
ungroup()
binary_sentiment
positivity_plot <- ggplot(data = tweet_score, aes(x=factor(word), y = total_score)) +
geom_bar(aes(fill = total_score < 0), stat = "identity") +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
scale_fill_manual(guide = FALSE, breaks = c(TRUE, FALSE), values=c("green", "red")) +
labs(x = "Most Common Words in Tweets",
y = "Positivity Score",
title = "Positivity of Tweets",
fill = "Positivity")
positivity_plot
sentiment <- ggplot(binary_sentiment[3:8,], aes(x = rev(factor(word, levels = unique(word))), y = n)) +
geom_bar(stat= "identity", aes(fill = sentiment)) +
coord_flip() +
labs(x = "Most Common Emotions",
y = "Frequency",
title = "Emotions Conveyed by Tweets",
fill = "Positivity")
sentiment
runApp()
tweet_info <- searchTwitter(paste0("#", "guns"), 30)
tweet_info_df <- twListToDF(tweet_info)
text <- data_frame(tweet = tweet_info_df$text) %>%
unnest_tokens(word, tweet)
tweet_score <- text %>%
inner_join(get_sentiments("afinn"), by = "word") %>%
count(word, score, sort = TRUE) %>%
ungroup()
tweet_sentiment <- text %>%
inner_join(get_sentiments("nrc"), by = "word") %>%
count(sentiment, sort = TRUE) %>%
ungroup() %>%
rename(word = emotion)
binary_sentiment <- tweet_sentiment %>%
inner_join(get_sentiments("bing"), by = "word") %>%
ungroup()
tweet_info <- searchTwitter(paste0("#", "guns"), 30)
tweet_info_df <- twListToDF(tweet_info)
runApp()
ggarrange(sentiment, positivity_plot,
labels = c("A", "B", "C"),
ncol = 1, nrow = 2)
library(ggpubr)
install.packages("ggpubr")
ggarrange(sentiment, positivity_plot,
labels = c("A", "B"),
ncol = 1, nrow = 2)
ggarrange(sentiment, positivity_plot,
labels = c("A", "B"),
ncol = 1, nrow = 2)
install.packages("ggpubr")
ggarrange(sentiment, positivity_plot,
labels = c("A", "B"),
ncol = 1, nrow = 2)
library(ggpubr)
ggarrange(sentiment, positivity_plot,
labels = c("A", "B"),
ncol = 1, nrow = 2)
ggarrange(sentiment, positivity_plot,
labels = c("A", "B"),
ncol = 2, nrow = 1)
